<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "DTD/xhtml1-strict.dtd">
<html>
  

  <head>
    
    <title>dire_jax.dire.DiRe</title>
    <meta name="generator" content="pydoctor 24.11.2"> 
        
    </meta>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1 maximum-scale=1" />
    <link rel="stylesheet" type="text/css" href="bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="apidocs.css" />
    <link rel="stylesheet" type="text/css" href="extra.css" />
    
</head>

  <body>

    

    <nav class="navbar navbar-default mainnavbar">
      
  
  <div class="container-fluid">


    <div class="navbar-header">
      
      <div class="navlinks">
        <span class="navbar-brand">
          Dimensionality Reduction with JAX <a href="index.html">API Documentation</a>
        </span>

        <a href="moduleIndex.html">
          Modules
        </a>

        <a href="classIndex.html">
          Classes
        </a>

        <a href="nameIndex.html">
          Names
        </a>

        <div id="search-box-container">
          <div class="input-group">
            <input id="search-box" type="search" name="search-query" placeholder="Search..." aria-label="Search" minlength="2" class="form-control" autocomplete="off" />
            
            <span class="input-group-btn">
              <a style="display: none;" class="btn btn-default" id="search-clear-button" title="Clear" onclick="clearSearch()"><img src="fonts/x-circle.svg" alt="Clear" /></a>
              <a class="btn btn-default" id="apidocs-help-button" title="Help" href="apidocs-help.html"><img src="fonts/info.svg" alt="Help" /></a>
            </span>
          </div>
        </div>

      </div>

      <div id="search-results-container" style="display: none;">
        
        <div id="search-buttons">
          <span class="label label-default" id="search-docstrings-button">
          <label class="checkbox-inline">
            <input type="checkbox" id="toggle-search-in-docstrings-checkbox" value="false" onclick="toggleSearchInDocstrings()">
              search in docstrings
            </input>
          </label>
          </span>
          
        </div>
        
        <noscript>
            <h1>Cannot search: JavaScript is not supported/enabled in your browser.</h1>
        </noscript>

        <div id="search-status"> </div>

        <div class="warning" id="search-warn-box" style="display: none;">
          <p class="rst-last"><span id="search-warn"></span></p>
        </div>

        <table id="search-results">
          <!-- Filled dynamically by JS -->
        </table>
        
        <div style="margin-top: 10px;">
          <p>For more information on the search, visit the <a href="apidocs-help.html#rst-search">help page</a>.</p>
        </div>
      </div>

    </div>


  </div>
</nav>
    
    <div class="container-fluid">

      <!-- Side navigation -->
      <div class="sidebarcontainer" style="display: none;">
        
        <div class="sidebar"><nav class="sidebar">
  

  <div>

      <div class="thingTitle">
        <span>Class</span>
        <code class="thisobject"><a href="dire_jax.dire.DiRe.html" class="internal-link" title="This class"><wbr></wbr>Di<wbr></wbr>Re</a></code> 
      </div>
      
      <div>
        

        
         

        
        

        <div class="childrenKindTitle">Methods</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="#__init__" class="internal-link" title="dire_jax.dire.DiRe.__init__">__init__</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#do_layout" class="internal-link" title="dire_jax.dire.DiRe.do_layout">do<wbr></wbr>_layout</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#do_pca_embedding" class="internal-link" title="dire_jax.dire.DiRe.do_pca_embedding">do<wbr></wbr>_pca<wbr></wbr>_embedding</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#do_rand_sampling" class="internal-link" title="dire_jax.dire.DiRe.do_rand_sampling">do<wbr></wbr>_rand<wbr></wbr>_sampling</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#do_random_embedding" class="internal-link" title="dire_jax.dire.DiRe.do_random_embedding">do<wbr></wbr>_random<wbr></wbr>_embedding</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#do_spectral_embedding" class="internal-link" title="dire_jax.dire.DiRe.do_spectral_embedding">do<wbr></wbr>_spectral<wbr></wbr>_embedding</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#find_ab_params" class="internal-link" title="dire_jax.dire.DiRe.find_ab_params">find<wbr></wbr>_ab<wbr></wbr>_params</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#fit" class="internal-link" title="dire_jax.dire.DiRe.fit">fit</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#fit_transform" class="internal-link" title="dire_jax.dire.DiRe.fit_transform">fit<wbr></wbr>_transform</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#make_knn_adjacency" class="internal-link" title="dire_jax.dire.DiRe.make_knn_adjacency">make<wbr></wbr>_knn<wbr></wbr>_adjacency</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#transform" class="internal-link" title="dire_jax.dire.DiRe.transform">transform</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#visualize" class="internal-link" title="dire_jax.dire.DiRe.visualize">visualize</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_compute_forces" class="internal-link" title="dire_jax.dire.DiRe._compute_forces">_compute<wbr></wbr>_forces</a></code>
            </div>
        

    </li>
</ul> 

        
         

        <div class="childrenKindTitle">Attributes</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="#cutoff" class="internal-link" title="dire_jax.dire.DiRe.cutoff">cutoff</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#dimension" class="internal-link" title="dire_jax.dire.DiRe.dimension">dimension</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#init_embedding_type" class="internal-link" title="dire_jax.dire.DiRe.init_embedding_type">init<wbr></wbr>_embedding<wbr></wbr>_type</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#logger" class="internal-link" title="dire_jax.dire.DiRe.logger">logger</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#max_iter_layout" class="internal-link" title="dire_jax.dire.DiRe.max_iter_layout">max<wbr></wbr>_iter<wbr></wbr>_layout</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#memm" class="internal-link" title="dire_jax.dire.DiRe.memm">memm</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#min_dist" class="internal-link" title="dire_jax.dire.DiRe.min_dist">min<wbr></wbr>_dist</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#n_neighbors" class="internal-link" title="dire_jax.dire.DiRe.n_neighbors">n<wbr></wbr>_neighbors</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#n_sample_dirs" class="internal-link" title="dire_jax.dire.DiRe.n_sample_dirs">n<wbr></wbr>_sample<wbr></wbr>_dirs</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#neg_ratio" class="internal-link" title="dire_jax.dire.DiRe.neg_ratio">neg<wbr></wbr>_ratio</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#pca_kernel" class="internal-link" title="dire_jax.dire.DiRe.pca_kernel">pca<wbr></wbr>_kernel</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#sample_size" class="internal-link" title="dire_jax.dire.DiRe.sample_size">sample<wbr></wbr>_size</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#sim_kernel" class="internal-link" title="dire_jax.dire.DiRe.sim_kernel">sim<wbr></wbr>_kernel</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="#spread" class="internal-link" title="dire_jax.dire.DiRe.spread">spread</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_a" class="internal-link" title="dire_jax.dire.DiRe._a">_a</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_adjacency" class="internal-link" title="dire_jax.dire.DiRe._adjacency">_adjacency</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_b" class="internal-link" title="dire_jax.dire.DiRe._b">_b</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_col_idx" class="internal-link" title="dire_jax.dire.DiRe._col_idx">_col<wbr></wbr>_idx</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_data" class="internal-link" title="dire_jax.dire.DiRe._data">_data</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_data_dim" class="internal-link" title="dire_jax.dire.DiRe._data_dim">_data<wbr></wbr>_dim</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_distances_jax" class="internal-link" title="dire_jax.dire.DiRe._distances_jax">_distances<wbr></wbr>_jax</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_distances_np" class="internal-link" title="dire_jax.dire.DiRe._distances_np">_distances<wbr></wbr>_np</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_indices_jax" class="internal-link" title="dire_jax.dire.DiRe._indices_jax">_indices<wbr></wbr>_jax</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_indices_np" class="internal-link" title="dire_jax.dire.DiRe._indices_np">_indices<wbr></wbr>_np</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_init_embedding" class="internal-link" title="dire_jax.dire.DiRe._init_embedding">_init<wbr></wbr>_embedding</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_layout" class="internal-link" title="dire_jax.dire.DiRe._layout">_layout</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_n_samples" class="internal-link" title="dire_jax.dire.DiRe._n_samples">_n<wbr></wbr>_samples</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_nearest_neighbor_distances" class="internal-link" title="dire_jax.dire.DiRe._nearest_neighbor_distances">_nearest<wbr></wbr>_neighbor<wbr></wbr>_distances</a></code>
            </div>
        

    </li><li class="private">
        
        
        

        
            <div class="itemName"><code><a href="#_row_idx" class="internal-link" title="dire_jax.dire.DiRe._row_idx">_row<wbr></wbr>_idx</a></code>
            </div>
        

    </li>
</ul> 

        
         
        
      </div>
  </div><div>

      <div class="thingTitle">
        <span>Module</span>
        <code><a href="dire_jax.dire.html" class="internal-link" title="The parent of this class">dire</a></code> 
      </div>
      
      <div>
        

        
         

        <div class="childrenKindTitle">Classes</div>
        <ul>
    
    <li class=" thisobject">
        
        
        

        
            <div class="itemName"><code><a href="dire_jax.dire.DiRe.html" class="internal-link" title="dire_jax.dire.DiRe"><wbr></wbr>Di<wbr></wbr>Re</a></code>
            </div>
        

    </li>
</ul>

        <div class="childrenKindTitle">Functions</div>
        <ul>
    
    <li class="">
        
        
        

        
            <div class="itemName"><code><a href="dire_jax.dire.html#compute_forces_kernel" class="internal-link" title="dire_jax.dire.compute_forces_kernel">compute<wbr></wbr>_forces<wbr></wbr>_kernel</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="dire_jax.dire.html#distribution_kernel" class="internal-link" title="dire_jax.dire.distribution_kernel">distribution<wbr></wbr>_kernel</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="dire_jax.dire.html#get_slice" class="internal-link" title="dire_jax.dire.get_slice">get<wbr></wbr>_slice</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="dire_jax.dire.html#jax_coeff_att" class="internal-link" title="dire_jax.dire.jax_coeff_att">jax<wbr></wbr>_coeff<wbr></wbr>_att</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="dire_jax.dire.html#jax_coeff_rep" class="internal-link" title="dire_jax.dire.jax_coeff_rep">jax<wbr></wbr>_coeff<wbr></wbr>_rep</a></code>
            </div>
        

    </li><li class="">
        
        
        

        
            <div class="itemName"><code><a href="dire_jax.dire.html#rand_directions" class="internal-link" title="dire_jax.dire.rand_directions">rand<wbr></wbr>_directions</a></code>
            </div>
        

    </li>
</ul> 

        
         

        
         

        
         
        
      </div>
  </div>

</nav>
        </div>
        <div id="collapseSideBar">
          <a class="btn btn-link" onclick="toggleSideBarCollapse()" title="Toggle Sidebar Collapse">
          </a>
        </div> 
        <script src="sidebartoggle.js" type="text/javascript"></script>
       
      </div>

      <div id="main" class="">
        

        

        <div class="page-header">
          <h1 class="class"><code><code><a href="index.html" class="internal-link">dire_jax</a></code><wbr></wbr>.<code><a href="dire_jax.dire.html" class="internal-link" title="dire_jax.dire">dire</a></code><wbr></wbr>.<code><a href="dire_jax.dire.DiRe.html" class="internal-link" title="dire_jax.dire.DiRe">DiRe</a></code></code></h1>
          <div id="showPrivate">
            <button class="btn btn-link" onclick="togglePrivate()">Toggle Private API</button>
          </div>
        </div>

        <div class="categoryHeader">
          class documentation
        </div>

        <div class="extrasDocstring">
          <p class="class-signature"><code><span class="py-keyword">class</span> <span class="py-defname">DiRe</span>:</code></p><p>Constructor: <code><a href="#__init__" class="internal-link" title="dire_jax.dire.DiRe.__init__">DiRe(dimension, n_neighbors, init_embedding_type, sim_kernel, ...)</a></code></p>
          <p><a href="classIndex.html#dire_jax.dire.DiRe">View In Hierarchy</a></p>
        </div>

        <div class="moduleDocstring">
          <div><p class="pre">Dimension Reduction (DiRe) is a class designed to reduce the dimensionality of high-dimensional
data using various embedding techniques and optimization algorithms. It supports embedding
initialization methods such as random and spectral embeddings and utilizes k-nearest neighbors
for manifold learning.

Parameters
----------
dimension: (int) Embedding dimension, default 2.
n_neighbors: (int) Number of nearest neighbors to consider for each point, default 16.
init_embedding_type: (str)
    Method to initialize the embedding; choices are:
     - 'random' for random projection based on the Johnson-Lindenstrauss lemma;
     - 'spectral' for spectral embedding (with sim_kernel as similarity kernel);
     - 'pca' for PCA embedding (classical, no kernel).
     By default, 'random'.
sim_kernel: (callable)
    A similarity kernel function that transforms a distance metric to a similarity score.
    The function should have the form `lambda distance: float -&gt; similarity: float`; default `None`.
max_iter_layout: (int)
    Maximum number of iterations to run the layout optimization, default 128.
min_dist: (float)
    Minimum distance scale for distribution kernel, default 0.01.
spread: (float)
    Spread of the distribution kernel, default 1.0.
cutoff: (float)
    Cutoff for clipping forces during layout optimization, default 42.0.
n_sample_dirs: (int)
    Number of directions to sample in random sampling, default 8.
sample_size: (int)
    Number of samples per direction in random sampling, default 16.
neg_ratio: (int)
    Ratio of negative to positive samples in random sampling, default 8.
my_logger: (logger.Logger or `None`)
    Custom logger for logging events; if None, a default logger is created, default `None`.
verbose: (bool)
    Flag to enable verbose output, default `True`.

Attributes
----------
dimension: int
    Target dimensionality of the output space.
n_neighbors: int
    Number of neighbors to consider in the k-nearest neighbors graph.
init_embedding_type: str
    Chosen method for initial embedding.
sim_kernel: callable
    Similarity kernel function to be used if 'init_embedding_type' is 'spectral', by default `None`.
pca_kernel: callable
    Kernel function to be used if 'init_embedding_type' is 'pca', by default `None`.
max_iter_layout: int
    Maximum iterations for optimizing the layout.
min_dist: float
    Minimum distance for repulsion used in the distribution kernel.
spread: float
    Spread between the data points used in the distribution kernel.
cutoff: float
    Maximum cutoff for forces during optimization.
n_sample_dirs: int
    Number of random directions sampled.
sample_size: int or 'auto'
    Number of samples per random direction, unless chosen automatically with 'auto'.
neg_ratio: int
    Ratio of negative to positive samples in the sampling process.
logger: logger.Logger or `None`
    Logger used for logging informational and warning messages.
memm: dictionary or `None'
    Memory manager: a dictionary with the batch / memory tile size for different
    hardware architectures. Accepts 'tpu', 'gpu' and 'other' as keys. Values must
    be positive integers.

Methods
-------
fit_transform(data)
    A convenience method that fits the model and then transforms the data.
    The separate `fit` and `transform` methods can only be used one after
    another because dimension reduction is applied to the dataset as a whole.
visualize(labels=None, point_size=2)
    Visualizes the transformed data, optionally using labels to color the points.</p></div>
        </div>

        <div id="splitTables">
          <table class="children sortable" id="id4">
  
  
  <tr class="method">
    
    <td>Method</td>
    <td><code><a href="#__init__" class="internal-link" title="dire_jax.dire.DiRe.__init__">__init__</a></code></td>
    <td>Class constructor</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#do_layout" class="internal-link" title="dire_jax.dire.DiRe.do_layout">do<wbr></wbr>_layout</a></code></td>
    <td>Optimize the layout using force-directed placement with JAX kernels.</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#do_pca_embedding" class="internal-link" title="dire_jax.dire.DiRe.do_pca_embedding">do<wbr></wbr>_pca<wbr></wbr>_embedding</a></code></td>
    <td>Initialize embedding using Principal Component Analysis (PCA).</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#do_rand_sampling" class="internal-link" title="dire_jax.dire.DiRe.do_rand_sampling">do<wbr></wbr>_rand<wbr></wbr>_sampling</a></code></td>
    <td>Sample points for force calculation using random projections.</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#do_random_embedding" class="internal-link" title="dire_jax.dire.DiRe.do_random_embedding">do<wbr></wbr>_random<wbr></wbr>_embedding</a></code></td>
    <td>Initialize embedding using Random Projection.</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#do_spectral_embedding" class="internal-link" title="dire_jax.dire.DiRe.do_spectral_embedding">do<wbr></wbr>_spectral<wbr></wbr>_embedding</a></code></td>
    <td>Initialize embedding using Spectral Embedding.</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#find_ab_params" class="internal-link" title="dire_jax.dire.DiRe.find_ab_params">find<wbr></wbr>_ab<wbr></wbr>_params</a></code></td>
    <td>Rational function approximation to the probabilistic t-kernel</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#fit" class="internal-link" title="dire_jax.dire.DiRe.fit">fit</a></code></td>
    <td>Fit the model to data: create the kNN graph and fit the probability kernel to force layout parameters.</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#fit_transform" class="internal-link" title="dire_jax.dire.DiRe.fit_transform">fit<wbr></wbr>_transform</a></code></td>
    <td>Fit the model to data and transform it into a low-dimensional layout.</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#make_knn_adjacency" class="internal-link" title="dire_jax.dire.DiRe.make_knn_adjacency">make<wbr></wbr>_knn<wbr></wbr>_adjacency</a></code></td>
    <td>Internal routine building the adjacency matrix for the kNN graph.</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#transform" class="internal-link" title="dire_jax.dire.DiRe.transform">transform</a></code></td>
    <td>Transform the fitted data into a lower-dimensional layout.</td>
  </tr><tr class="method">
    
    <td>Method</td>
    <td><code><a href="#visualize" class="internal-link" title="dire_jax.dire.DiRe.visualize">visualize</a></code></td>
    <td>Generate an interactive visualization of the data in the transformed space.</td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#cutoff" class="internal-link" title="dire_jax.dire.DiRe.cutoff">cutoff</a></code></td>
    <td>Cutoff for layout displacement</td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#dimension" class="internal-link" title="dire_jax.dire.DiRe.dimension">dimension</a></code></td>
    <td>Embedding dimension</td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#init_embedding_type" class="internal-link" title="dire_jax.dire.DiRe.init_embedding_type">init<wbr></wbr>_embedding<wbr></wbr>_type</a></code></td>
    <td>Type of the initial embedding (PCA, random, spectral)</td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#logger" class="internal-link" title="dire_jax.dire.DiRe.logger">logger</a></code></td>
    <td>System logger</td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#max_iter_layout" class="internal-link" title="dire_jax.dire.DiRe.max_iter_layout">max<wbr></wbr>_iter<wbr></wbr>_layout</a></code></td>
    <td>Max iterations for the force layout</td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#memm" class="internal-link" title="dire_jax.dire.DiRe.memm">memm</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#min_dist" class="internal-link" title="dire_jax.dire.DiRe.min_dist">min<wbr></wbr>_dist</a></code></td>
    <td>Min distance between points in layout</td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#n_neighbors" class="internal-link" title="dire_jax.dire.DiRe.n_neighbors">n<wbr></wbr>_neighbors</a></code></td>
    <td>Number of neighbors for kNN computations</td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#n_sample_dirs" class="internal-link" title="dire_jax.dire.DiRe.n_sample_dirs">n<wbr></wbr>_sample<wbr></wbr>_dirs</a></code></td>
    <td>Number of sampling directions for layout</td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#neg_ratio" class="internal-link" title="dire_jax.dire.DiRe.neg_ratio">neg<wbr></wbr>_ratio</a></code></td>
    <td>Ratio for repulsion sample size</td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#pca_kernel" class="internal-link" title="dire_jax.dire.DiRe.pca_kernel">pca<wbr></wbr>_kernel</a></code></td>
    <td>PCA kernel</td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#sample_size" class="internal-link" title="dire_jax.dire.DiRe.sample_size">sample<wbr></wbr>_size</a></code></td>
    <td>Sample size for attraction</td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#sim_kernel" class="internal-link" title="dire_jax.dire.DiRe.sim_kernel">sim<wbr></wbr>_kernel</a></code></td>
    <td>Similarity kernel</td>
  </tr><tr class="instancevariable">
    
    <td>Instance Variable</td>
    <td><code><a href="#spread" class="internal-link" title="dire_jax.dire.DiRe.spread">spread</a></code></td>
    <td>Layout spread</td>
  </tr><tr class="method private">
    
    <td>Method</td>
    <td><code><a href="#_compute_forces" class="internal-link" title="dire_jax.dire.DiRe._compute_forces">_compute<wbr></wbr>_forces</a></code></td>
    <td>Compute attractive and repulsive forces for points using JAX kernels.</td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_a" class="internal-link" title="dire_jax.dire.DiRe._a">_a</a></code></td>
    <td>Probability kernel parameter</td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_adjacency" class="internal-link" title="dire_jax.dire.DiRe._adjacency">_adjacency</a></code></td>
    <td>kNN adjacency matrix</td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_b" class="internal-link" title="dire_jax.dire.DiRe._b">_b</a></code></td>
    <td>Probability kernel parameter</td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_col_idx" class="internal-link" title="dire_jax.dire.DiRe._col_idx">_col<wbr></wbr>_idx</a></code></td>
    <td>Column indices for nearest neighbors</td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_data" class="internal-link" title="dire_jax.dire.DiRe._data">_data</a></code></td>
    <td>Higher-dimensional data</td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_data_dim" class="internal-link" title="dire_jax.dire.DiRe._data_dim">_data<wbr></wbr>_dim</a></code></td>
    <td>Dimension of data</td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_distances_jax" class="internal-link" title="dire_jax.dire.DiRe._distances_jax">_distances<wbr></wbr>_jax</a></code></td>
    <td>Distances in the kNN graph</td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_distances_np" class="internal-link" title="dire_jax.dire.DiRe._distances_np">_distances<wbr></wbr>_np</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_indices_jax" class="internal-link" title="dire_jax.dire.DiRe._indices_jax">_indices<wbr></wbr>_jax</a></code></td>
    <td>Neighbor indices in the kNN graph</td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_indices_np" class="internal-link" title="dire_jax.dire.DiRe._indices_np">_indices<wbr></wbr>_np</a></code></td>
    <td><span class="undocumented">Undocumented</span></td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_init_embedding" class="internal-link" title="dire_jax.dire.DiRe._init_embedding">_init<wbr></wbr>_embedding</a></code></td>
    <td>Initial embedding</td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_layout" class="internal-link" title="dire_jax.dire.DiRe._layout">_layout</a></code></td>
    <td>Layout output</td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_n_samples" class="internal-link" title="dire_jax.dire.DiRe._n_samples">_n<wbr></wbr>_samples</a></code></td>
    <td>Number of data points</td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_nearest_neighbor_distances" class="internal-link" title="dire_jax.dire.DiRe._nearest_neighbor_distances">_nearest<wbr></wbr>_neighbor<wbr></wbr>_distances</a></code></td>
    <td>Neighbor indices in the kNN graph, excluding the point itself</td>
  </tr><tr class="instancevariable private">
    
    <td>Instance Variable</td>
    <td><code><a href="#_row_idx" class="internal-link" title="dire_jax.dire.DiRe._row_idx">_row<wbr></wbr>_idx</a></code></td>
    <td>Row indices for nearest neighbors</td>
  </tr>
</table>
          

            
        </div>

        <div id="childList">
          <div class="basemethod">
  
  
  <a name="dire_jax.dire.DiRe.__init__">
    
  </a>
  <a name="__init__">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">__init__</span><span class="function-signature">(self, dimension=2, n_neighbors=16, init_embedding_type=<span class="rst-variable-quote">'</span><span class="rst-variable-string">random</span><span class="rst-variable-quote">'</span>, sim_kernel=None, pca_kernel=None, max_iter_layout=128, min_dist=0.01, spread=1.0, cutoff=42.0, n_sample_dirs=8, sample_size=16, neg_ratio=8, my_logger=None, verbose=True, memm=None)</span>:
    
    <a class="headerLink" href="#__init__" title="dire_jax.dire.DiRe.__init__">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Class constructor</p></div>
  </div>
</div><div class="basemethod">
  
  
  <a name="dire_jax.dire.DiRe.do_layout">
    
  </a>
  <a name="do_layout">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">do_layout</span><span class="function-signature">(self, large_dataset_mode=None, force_cpu=False)</span>:
    
    <a class="headerLink" href="#do_layout" title="dire_jax.dire.DiRe.do_layout">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Optimize the layout using force-directed placement with JAX kernels.

This method takes the initial embedding and iteratively refines it using
attractive and repulsive forces to create a meaningful low-dimensional
representation of the high-dimensional data. The algorithm applies:

1. Attraction forces between points that are neighbors in the high-dimensional space
2. Repulsion forces between randomly sampled points in the low-dimensional space
3. Gradual cooling (decreasing force impact) as iterations progress

The final layout is normalized to have zero mean and unit standard deviation.

Parameters
----------
large_dataset_mode : bool or None, optional
    If True, use memory-efficient techniques for large datasets.
    If None, automatically determine based on dataset size.
force_cpu : bool, optional
    If True, force computations on CPU instead of GPU, which can
    be helpful for large datasets that exceed GPU memory.</p></div>
  </div>
</div><div class="basemethod">
  
  
  <a name="dire_jax.dire.DiRe.do_pca_embedding">
    
  </a>
  <a name="do_pca_embedding">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">do_pca_embedding</span><span class="function-signature">(self)</span>:
    
    <a class="headerLink" href="#do_pca_embedding" title="dire_jax.dire.DiRe.do_pca_embedding">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Initialize embedding using Principal Component Analysis (PCA).</p>
<p>This method creates an initial embedding of the data using PCA, which finds a linear projection of the high-dimensional data into a lower-dimensional space that maximizes the variance. If a kernel is specified, Kernel PCA is used instead, which can capture nonlinear relationships.</p>
<p>Sets the init_embedding attribute with the PCA projection of the data.</p>
</div>
  </div>
</div><div class="basemethod">
  
  
  <a name="dire_jax.dire.DiRe.do_rand_sampling">
    
  </a>
  <a name="do_rand_sampling">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">do_rand_sampling</span><span class="function-signature">(self, key, arr, n_samples, n_dirs, neg_ratio)</span>:
    
    <a class="headerLink" href="#do_rand_sampling" title="dire_jax.dire.DiRe.do_rand_sampling">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Sample points for force calculation using random projections.

This method implements an efficient sampling strategy to identify points
for applying attractive and repulsive forces during layout optimization.
It uses random projections to quickly identify nearby points in different
directions, and also adds random negative samples for repulsion.

Parameters
----------
key : jax.random.PRNGKey
    Random number generator key
arr : jax.numpy.ndarray
    Array of current point positions
n_samples : int
    Number of samples to take in each direction
n_dirs : int
    Number of random directions to sample
neg_ratio : int
    Ratio of negative samples to positive samples
    
Returns
-------
jax.numpy.ndarray
    Array of sampled indices for force calculations
    
Notes
-----
The sampling strategy works as follows:
1. Generate n_dirs random unit vectors
2. Project the points onto each vector
3. For each point, take the n_samples closest points in each direction
4. Add random negative samples for repulsion
5. Combine all sampled indices

This approach is more efficient than a full nearest neighbor search
while still capturing the important local relationships.</p></div>
  </div>
</div><div class="basemethod">
  
  
  <a name="dire_jax.dire.DiRe.do_random_embedding">
    
  </a>
  <a name="do_random_embedding">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">do_random_embedding</span><span class="function-signature">(self)</span>:
    
    <a class="headerLink" href="#do_random_embedding" title="dire_jax.dire.DiRe.do_random_embedding">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Initialize embedding using Random Projection.</p>
<p>This method creates an initial embedding of the data using random projection, which is a simple and computationally efficient technique for dimensionality reduction. It projects the data onto a randomly generated basis, providing a good starting point for further optimization.</p>
<p>Random projection is supported by the Johnson-Lindenstrauss lemma, which guarantees that the distances between points are approximately preserved under certain conditions.</p>
<p>Sets the init_embedding attribute with the random projection of the data.</p>
</div>
  </div>
</div><div class="basemethod">
  
  
  <a name="dire_jax.dire.DiRe.do_spectral_embedding">
    
  </a>
  <a name="do_spectral_embedding">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">do_spectral_embedding</span><span class="function-signature">(self)</span>:
    
    <a class="headerLink" href="#do_spectral_embedding" title="dire_jax.dire.DiRe.do_spectral_embedding">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Initialize embedding using Spectral Embedding.</p>
<p>This method creates an initial embedding of the data using spectral embedding, which is based on the eigenvectors of the graph Laplacian. It relies on the kNN graph structure to find a lower-dimensional representation that preserves local relationships.</p>
<p>If a similarity kernel is specified, it is applied to transform the distances in the adjacency matrix before computing the Laplacian.</p>
<p>Sets the init_embedding attribute with the spectral embedding of the data.</p>
</div>
  </div>
</div><div class="basemethod">
  
  
  <a name="dire_jax.dire.DiRe.find_ab_params">
    
  </a>
  <a name="find_ab_params">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">find_ab_params</span><span class="function-signature">(self, min_dist=0.01, spread=1.0)</span>:
    
    <a class="headerLink" href="#find_ab_params" title="dire_jax.dire.DiRe.find_ab_params">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p>Rational function approximation to the probabilistic t-kernel</p></div>
  </div>
</div><div class="basemethod">
  
  
  <a name="dire_jax.dire.DiRe.fit">
    
  </a>
  <a name="fit">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">fit</span><span class="function-signature">(self, data)</span>:
    
    <a class="headerLink" href="#fit" title="dire_jax.dire.DiRe.fit">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Fit the model to data: create the kNN graph and fit the probability kernel to force layout parameters.

Parameters
----------
data: (numpy.ndarray)
    High-dimensional data to fit the model. Shape (n_samples, n_features).

Returns
-------
self: The DiRe instance fitted to data.</p></div>
  </div>
</div><div class="basemethod">
  
  
  <a name="dire_jax.dire.DiRe.fit_transform">
    
  </a>
  <a name="fit_transform">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">fit_transform</span><span class="function-signature">(self, data)</span>:
    
    <a class="headerLink" href="#fit_transform" title="dire_jax.dire.DiRe.fit_transform">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Fit the model to data and transform it into a low-dimensional layout.

This is a convenience method that combines the fitting and transformation
steps. It first builds the kNN graph and then creates the optimized
layout in a single operation.

Parameters
----------
data : numpy.ndarray
    High-dimensional data to fit and transform.
    Shape (n_samples, n_features)
    
Returns
-------
numpy.ndarray
    The lower-dimensional embedding of the data.
    Shape (n_samples, dimension)
    
Notes
-----
This method is more memory-efficient than calling fit() and transform()
separately, as it avoids storing intermediate results.</p></div>
  </div>
</div><div class="basemethod">
  
  
  <a name="dire_jax.dire.DiRe.make_knn_adjacency">
    
  </a>
  <a name="make_knn_adjacency">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">make_knn_adjacency</span><span class="function-signature">(self, batch_size=None)</span>:
    
    <a class="headerLink" href="#make_knn_adjacency" title="dire_jax.dire.DiRe.make_knn_adjacency">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Internal routine building the adjacency matrix for the kNN graph.

This method computes the k-nearest neighbors for each point in the dataset
and constructs a sparse adjacency matrix representing the kNN graph.
It attempts to use GPU acceleration if available, with a fallback to CPU.

For large datasets, it uses batching to limit memory usage.

Parameters
----------
batch_size : int or None, optional
    Number of samples to process at once. If None, a suitable value
    will be automatically determined based on dataset size.

The method sets the following instance attributes:
- distances: Distances to the k nearest neighbors (including self)
- indices: Indices of the k nearest neighbors (including self)
- nearest_neighbor_distances: Distances to the nearest neighbors (excluding self)
- row_idx, col_idx: Indices for constructing the sparse adjacency matrix
- adjacency: Sparse adjacency matrix of the kNN graph</p></div>
  </div>
</div><div class="basemethod">
  
  
  <a name="dire_jax.dire.DiRe.transform">
    
  </a>
  <a name="transform">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">transform</span><span class="function-signature">(self)</span>:
    
    <a class="headerLink" href="#transform" title="dire_jax.dire.DiRe.transform">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Transform the fitted data into a lower-dimensional layout.

This method applies the selected embedding initialization technique
to the data that has already been fitted (creating the kNN graph), 
and then optimizes the layout using force-directed placement.

The transformation process involves:
1. Creating an initial embedding using the specified method
   (random projection, PCA, or spectral embedding)
2. Optimizing the layout with attractive and repulsive forces

Returns
-------
numpy.ndarray
    The lower-dimensional data embedding with shape (n_samples, dimension).
    Points are arranged to preserve the local structure of the original data.
    
Raises
------
ValueError
    If an unsupported embedding initialization method is specified.</p></div>
  </div>
</div><div class="basemethod">
  
  
  <a name="dire_jax.dire.DiRe.visualize">
    
  </a>
  <a name="visualize">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">visualize</span><span class="function-signature">(self, labels=None, point_size=2, title=None, colormap=None, width=800, height=600, opacity=0.7)</span>:
    
    <a class="headerLink" href="#visualize" title="dire_jax.dire.DiRe.visualize">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Generate an interactive visualization of the data in the transformed space.

This method creates a scatter plot visualization of the embedded data, supporting
both 2D and 3D visualizations depending on the specified dimension. Points can be
colored by provided labels for clearer visualization of clusters or categories.

Parameters
----------
labels : numpy.ndarray or None, optional
    Labels for each data point to color the points in the visualization.
    If None, all points will have the same color. Default is None.
point_size : int or float, optional
    Size of points in the scatter plot. Default is 2.
title : str or None, optional
    Title for the visualization. If None, a default title will be used. Default is None.
colormap : str or None, optional
    Name of the colormap to use for labels (e.g., 'viridis', 'plasma'). 
    If None, the default Plotly colormap will be used. Default is None.
width : int, optional
    Width of the figure in pixels. Default is 800.
height : int, optional
    Height of the figure in pixels. Default is 600.
opacity : float, optional
    Opacity of the points (0.0 to 1.0). Default is 0.7.
    
Returns
-------
plotly.graph_objs._figure.Figure or None
    A Plotly figure object if the visualization is successful; 
    None if no layout is available or dimension &gt; 3.

Notes
-----
For 3D visualizations, you can rotate, zoom, and pan the plot interactively.
For both 2D and 3D, hover over points to see their coordinates and labels.</p></div>
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="dire_jax.dire.DiRe.cutoff">
    
  </a>
  <a name="cutoff">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">cutoff</span> =
    
    <a class="headerLink" href="#cutoff" title="dire_jax.dire.DiRe.cutoff">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Cutoff for layout displacement</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="dire_jax.dire.DiRe.dimension">
    
  </a>
  <a name="dimension">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">dimension</span> =
    
    <a class="headerLink" href="#dimension" title="dire_jax.dire.DiRe.dimension">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Embedding dimension</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="dire_jax.dire.DiRe.init_embedding_type">
    
  </a>
  <a name="init_embedding_type">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">init_embedding_type</span> =
    
    <a class="headerLink" href="#init_embedding_type" title="dire_jax.dire.DiRe.init_embedding_type">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Type of the initial embedding (PCA, random, spectral)</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="dire_jax.dire.DiRe.logger">
    
  </a>
  <a name="logger">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">logger</span> =
    
    <a class="headerLink" href="#logger" title="dire_jax.dire.DiRe.logger">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>System logger</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="dire_jax.dire.DiRe.max_iter_layout">
    
  </a>
  <a name="max_iter_layout">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">max_iter_layout</span> =
    
    <a class="headerLink" href="#max_iter_layout" title="dire_jax.dire.DiRe.max_iter_layout">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Max iterations for the force layout</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="dire_jax.dire.DiRe.memm">
    
  </a>
  <a name="memm">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">memm</span> =
    
    <a class="headerLink" href="#memm" title="dire_jax.dire.DiRe.memm">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="dire_jax.dire.DiRe.min_dist">
    
  </a>
  <a name="min_dist">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">min_dist</span> =
    
    <a class="headerLink" href="#min_dist" title="dire_jax.dire.DiRe.min_dist">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Min distance between points in layout</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="dire_jax.dire.DiRe.n_neighbors">
    
  </a>
  <a name="n_neighbors">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">n_neighbors</span> =
    
    <a class="headerLink" href="#n_neighbors" title="dire_jax.dire.DiRe.n_neighbors">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Number of neighbors for kNN computations</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="dire_jax.dire.DiRe.n_sample_dirs">
    
  </a>
  <a name="n_sample_dirs">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">n_sample_dirs</span> =
    
    <a class="headerLink" href="#n_sample_dirs" title="dire_jax.dire.DiRe.n_sample_dirs">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Number of sampling directions for layout</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="dire_jax.dire.DiRe.neg_ratio">
    
  </a>
  <a name="neg_ratio">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">neg_ratio</span> =
    
    <a class="headerLink" href="#neg_ratio" title="dire_jax.dire.DiRe.neg_ratio">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Ratio for repulsion sample size</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="dire_jax.dire.DiRe.pca_kernel">
    
  </a>
  <a name="pca_kernel">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">pca_kernel</span> =
    
    <a class="headerLink" href="#pca_kernel" title="dire_jax.dire.DiRe.pca_kernel">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>PCA kernel</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="dire_jax.dire.DiRe.sample_size">
    
  </a>
  <a name="sample_size">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">sample_size</span> =
    
    <a class="headerLink" href="#sample_size" title="dire_jax.dire.DiRe.sample_size">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Sample size for attraction</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="dire_jax.dire.DiRe.sim_kernel">
    
  </a>
  <a name="sim_kernel">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">sim_kernel</span> =
    
    <a class="headerLink" href="#sim_kernel" title="dire_jax.dire.DiRe.sim_kernel">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Similarity kernel</p></div>
    
  </div>
</div><div class="baseinstancevariable">
  
  
  <a name="dire_jax.dire.DiRe.spread">
    
  </a>
  <a name="spread">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">spread</span> =
    
    <a class="headerLink" href="#spread" title="dire_jax.dire.DiRe.spread">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Layout spread</p></div>
    
  </div>
</div><div class="basemethod private">
  
  
  <a name="dire_jax.dire.DiRe._compute_forces">
    
  </a>
  <a name="_compute_forces">
    
  </a>
  <div class="functionHeader">
    
    
    <span class="py-keyword">def</span> <span class="py-defname">_compute_forces</span><span class="function-signature">(self, positions, chunk_indices, neighbor_indices, sample_indices, alpha=1.0)</span>:
    
    <a class="headerLink" href="#_compute_forces" title="dire_jax.dire.DiRe._compute_forces">
      
      
      ¶
    </a>
  </div>
  <div class="docstring functionBody">
    
    <div><p class="pre">Compute attractive and repulsive forces for points using JAX kernels.

This method uses JAX-optimized kernels to efficiently compute forces
between points during layout optimization.

Parameters
----------
positions : jax.numpy.ndarray
    Current point positions
chunk_indices : jax.numpy.ndarray
    Current batch indices
neighbor_indices : jax.numpy.ndarray
    Indices of neighbors for attractive forces
sample_indices : jax.numpy.ndarray
    Indices of points for repulsive forces
alpha : float
    Cooling factor that scales force magnitude

Returns
-------
jax.numpy.ndarray
    Net force vectors for each point</p></div>
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="dire_jax.dire.DiRe._a">
    
  </a>
  <a name="_a">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_a</span> =
    
    <a class="headerLink" href="#_a" title="dire_jax.dire.DiRe._a">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Probability kernel parameter</p></div>
    
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="dire_jax.dire.DiRe._adjacency">
    
  </a>
  <a name="_adjacency">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_adjacency</span> =
    
    <a class="headerLink" href="#_adjacency" title="dire_jax.dire.DiRe._adjacency">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>kNN adjacency matrix</p></div>
    
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="dire_jax.dire.DiRe._b">
    
  </a>
  <a name="_b">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_b</span> =
    
    <a class="headerLink" href="#_b" title="dire_jax.dire.DiRe._b">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Probability kernel parameter</p></div>
    
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="dire_jax.dire.DiRe._col_idx">
    
  </a>
  <a name="_col_idx">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_col_idx</span> =
    
    <a class="headerLink" href="#_col_idx" title="dire_jax.dire.DiRe._col_idx">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Column indices for nearest neighbors</p></div>
    
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="dire_jax.dire.DiRe._data">
    
  </a>
  <a name="_data">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_data</span> =
    
    <a class="headerLink" href="#_data" title="dire_jax.dire.DiRe._data">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Higher-dimensional data</p></div>
    
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="dire_jax.dire.DiRe._data_dim">
    
  </a>
  <a name="_data_dim">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_data_dim</span> =
    
    <a class="headerLink" href="#_data_dim" title="dire_jax.dire.DiRe._data_dim">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Dimension of data</p></div>
    
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="dire_jax.dire.DiRe._distances_jax">
    
  </a>
  <a name="_distances_jax">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_distances_jax</span> =
    
    <a class="headerLink" href="#_distances_jax" title="dire_jax.dire.DiRe._distances_jax">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Distances in the kNN graph</p></div>
    
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="dire_jax.dire.DiRe._distances_np">
    
  </a>
  <a name="_distances_np">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_distances_np</span> =
    
    <a class="headerLink" href="#_distances_np" title="dire_jax.dire.DiRe._distances_np">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="dire_jax.dire.DiRe._indices_jax">
    
  </a>
  <a name="_indices_jax">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_indices_jax</span> =
    
    <a class="headerLink" href="#_indices_jax" title="dire_jax.dire.DiRe._indices_jax">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Neighbor indices in the kNN graph</p></div>
    
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="dire_jax.dire.DiRe._indices_np">
    
  </a>
  <a name="_indices_np">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_indices_np</span> =
    
    <a class="headerLink" href="#_indices_np" title="dire_jax.dire.DiRe._indices_np">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p class="undocumented">Undocumented</p></div>
    
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="dire_jax.dire.DiRe._init_embedding">
    
  </a>
  <a name="_init_embedding">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_init_embedding</span> =
    
    <a class="headerLink" href="#_init_embedding" title="dire_jax.dire.DiRe._init_embedding">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Initial embedding</p></div>
    
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="dire_jax.dire.DiRe._layout">
    
  </a>
  <a name="_layout">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_layout</span> =
    
    <a class="headerLink" href="#_layout" title="dire_jax.dire.DiRe._layout">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Layout output</p></div>
    
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="dire_jax.dire.DiRe._n_samples">
    
  </a>
  <a name="_n_samples">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_n_samples</span> =
    
    <a class="headerLink" href="#_n_samples" title="dire_jax.dire.DiRe._n_samples">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Number of data points</p></div>
    
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="dire_jax.dire.DiRe._nearest_neighbor_distances">
    
  </a>
  <a name="_nearest_neighbor_distances">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_nearest_neighbor_distances</span> =
    
    <a class="headerLink" href="#_nearest_neighbor_distances" title="dire_jax.dire.DiRe._nearest_neighbor_distances">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Neighbor indices in the kNN graph, excluding the point itself</p></div>
    
  </div>
</div><div class="baseinstancevariable private">
  
  
  <a name="dire_jax.dire.DiRe._row_idx">
    
  </a>
  <a name="_row_idx">
    
  </a>
  <div class="functionHeader">
    
    <span class="py-defname">_row_idx</span> =
    
    <a class="headerLink" href="#_row_idx" title="dire_jax.dire.DiRe._row_idx">
      
      
      ¶
    </a>
  </div>
  <div class="functionBody">
    
    <div><p>Row indices for nearest neighbors</p></div>
    
  </div>
</div>
        </div>
      
      </div>
    </div>

    <footer class="navbar navbar-default">

  
  <div class="container-fluid">
    <a href="index.html">API Documentation</a> for Dimensionality Reduction with JAX,
  generated by <a href="https://github.com/twisted/pydoctor/">pydoctor</a>
    24.11.2 at 2025-04-03 01:19:39.
  </div>

  <!-- Search related scripts needs to be loaded at the end of HTML 
    parsing not to introduce overhead and display HTML data asap -->
  <script src="ajax.js" type="text/javascript"></script>
  <script src="searchlib.js" type="text/javascript"></script>
  <script src="search.js" type="text/javascript"></script>

</footer>
  
    <script src="pydoctor.js" type="text/javascript"></script>

  </body>
</html>